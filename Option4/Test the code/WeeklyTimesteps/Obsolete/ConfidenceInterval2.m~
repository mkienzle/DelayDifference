% CREATED  12 June 2012
% MODIFIED 12 June 2012

% PURPOSE calculate uncertainties on parameter estimates using the Jacobian as suggested by John D'Errico

% METHOD uses John D'Errico library called Adaptive Robust Numerical Differentiation available from MATLAB Central

% Create a function suitable for John D'Errico library
fun = @(par) EKPLogLikDelayDifferenceBIS(par,cpue);

% Calculate the Jacobian at the Maximum Likelihood
[jac, err] = jacobianest(fun, mle)

% Calculate the covariance matrix (S) given the error variance (s2) provided by EKPLogLikDelayDifference
s2 = 7.0255;
S = s2 * inv(jac' * jac) 

% Parameter uncertainty
error = sqrt(diag(7.0255 * inv(jac' * jac)));