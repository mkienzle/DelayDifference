expand.grid( cbind(vb.Linf = seq(0.9, 1.1,0.01), vb.k = seq(0.9,1.1, 0.01), k = seq(19, 25)) 
)
expand.grid( vb.Linf = seq(0.9, 1.1,0.01), vb.k = seq(0.9,1.1, 0.01), k = seq(19, 25)) 
expand.grid( vb.Linf = seq(0.9, 1.1,0.02), vb.k = seq(0.9,1.1, 0.02), k = seq(19, 25)) 
expand.grid( vb.Linf = seq(0.9, 1.1,0.02), vb.k = seq(0.9,1.1, 0.02), k = seq(19, 25)) 
expand.grid( vb.Linf = seq(0.9, 1.1,0.02), vb.k = seq(0.9,1.1, 0.02), k = seq(19, 25))
source("TestSensitivity.R")
?system
system("DelayDifference_Option3 Data/SimData4.txt FixParameters.txt", intern=FALSE)
source("SimulatePopDynamic2.R")
system("DelayDifference_Option3 Data/SimData4.txt FixParameters.txt", intern=FALSE)
system("DelayDifference_Option3 Data/SimData4.txt FixWeeklyParameters.txt", intern=FALSE)
system("DelayDifference_Option3 Data/SimData4.txt FixedWeeklyParameters.txt", intern=FALSE)
DDfit <- system("DelayDifference_Option3 Data/SimData4.txt FixedWeeklyParameters.txt", intern=FALSE)
DDfit
source("UsefulFunctions.R")
GenerateSomaticGrowthParameters(1,1,22)
GenerateSomaticGrowthParameters(1,1,21)
GenerateSomaticGrowthParameters(0.9,1,21)
source("UsefulFunctions.R")
GenerateSomaticGrowthParameters(0.9,1,21)
source("UsefulFunctions.R")
GenerateSomaticGrowthParameters(0.9,1,21)
source("UsefulFunctions.R")
GenerateSomaticGrowthParameters(0.9,1,21)
source("UsefulFunctions.R")
GenerateSomaticGrowthParameters(0.9,1,21)
source("UsefulFunctions.R")
GenerateSomaticGrowthParameters(0.9,1,21)
source("UsefulFunctions.R")
GenerateSomaticGrowthParameters(0.9,1,21)
system("ls")
system("cat FixedWeeklyParameters.txt")
?write.table
?write
?scan
?cat
fixed.par <- GenerateSomaticGrowthParameters(0.9,1,21)
source("UsefulFunctions.R")
write.inputfile(fixed.par)
system("cat FixedWeeklyParameters.txt")
?cat
source("UsefulFunctions.R")
write.inputfile(fixed.par)
system("cat FixedWeeklyParameters.txt")
source("UsefulFunctions.R")
write.inputfile(fixed.par)
system("cat FixedWeeklyParameters.txt")
head(results)
results[1,]$vb.Linf.factor
results[1,"vb.Linf.factor"]
results <- expand.grid( vb.Linf.factor = seq(0.9, 1.1,0.02), vb.k.factor = seq(0.9,1.1, 0.02), rec.age = seq(19, 25))
# Generate a simulated dataset
source("SimulatePopDynamic2.R")
# Loop over, create the input file and fit the model
for(i in 1:nrow(results)){
    
    fixed.par <- GenerateSomaticGrowthParameters(results[i,"vb.Linf.factor"],  results[i,"vb.k.factor"], results[i,"rec.age"])
}
source("TestSensitivity.R")
system("DelayDifference_Option3 Data/SimData4.txt FixedWeeklyParameters.txt", intern=FALSE)
source("TestSensitivity.R")
source("TestSensitivity.R")
source("TestSensitivity.R")
system("cat FixedWeeklyParameters.txt")
system("cat ../FixedWeeklyParameters.txt")
results
source("TestSensitivity.R")
GenerateSomaticGrowthParameters()
GenerateSomaticGrowthParameters(c(1,1,22))
GenerateSomaticGrowthParameters()
GenerateSomaticGrowthParameters(1,1,22)
results
results <- expand.grid( vb.Linf.factor = 1, vb.k.factor = 1, rec.age = 22)
# Generate a simulated dataset
source("SimulatePopDynamic2.R")
    fixed.par <- GenerateSomaticGrowthParameters(results[i,"vb.Linf.factor"],  results[i,"vb.k.factor"], results[i,"rec.age"])
    fit <- system("DelayDifference_Option3 Data/SimData4.txt FixedWeeklyParameters.txt", intern=FALSE)
    fixed.par <- GenerateSomaticGrowthParameters(results[i,"vb.Linf.factor"],  results[i,"vb.k.factor"], results[i,"rec.age"])
results
    fixed.par <- GenerateSomaticGrowthParameters(results[i,"vb.Linf.factor"],  results[i,"vb.k.factor"], rec.age = results[i,"rec.age"])
source("UsefulFunctions.R")
    fixed.par <- GenerateSomaticGrowthParameters(results[i,"vb.Linf.factor"],  results[i,"vb.k.factor"], results[i,"rec.age"])
GenerateSomaticGrowthParameters()
source("UsefulFunctions.R")
GenerateSomaticGrowthParameters()
GenerateSomaticGrowthParameters(rec.age = 2)
    fixed.par <- GenerateSomaticGrowthParameters(results[i,"vb.Linf.factor"],  results[i,"vb.k.factor"], rec.age = results[i,"rec.age"])
    fixed.par <- GenerateSomaticGrowthParameters(results[i,"vb.Linf.factor"],  results[i,"vb.k.factor"], rec.age = as.numeric(results[i,"rec.age"]))
i
i<-1
    fixed.par <- GenerateSomaticGrowthParameters(results[i,"vb.Linf.factor"],  results[i,"vb.k.factor"], results[i,"rec.age"])
system("DelayDifference_Option3 Data/SimData4.txt FixedWeeklyParameters.txt", intern=FALSE)
source("SimulatePopDynamic2.R")
system("DelayDifference_Option3 Data/SimData4.txt FixedWeeklyParameters.txt", intern=FALSE)
source("SimulatePopDynamic2.R")
system("DelayDifference_Option3 Data/SimData4.txt FixedWeeklyParameters.txt", intern=FALSE)
system("DelayDifference_Option3 Data/SimData4.txt FixedWeeklyParameters.txt", intern=FALSE)
system("cat ../FixedWeeklyParameters.txt")
write.inputfile(fixed.par)
    fixed.par <- GenerateSomaticGrowthParameters(results[i,"vb.Linf.factor"],  results[i,"vb.k.factor"], results[i,"rec.age"])
    write.inputfile(fixed.par)
    fit <- system("DelayDifference_Option3 Data/SimData4.txt FixedWeeklyParameters.txt", intern=FALSE)
system("cat ../FixedWeeklyParameters.txt")
    fit <- system("DelayDifference_Option3 Data/SimData4.txt FixedWeeklyParameters.txt", intern=FALSE)
system("cat ../FixedWeeklyParameters.txt")
    write.inputfile(fixed.par)
system("cat ../FixedWeeklyParameters.txt")
fixed.par
    write.inputfile(fixed.par)
    fit <- system("DelayDifference_Option3 Data/SimData4.txt FixedWeeklyParameters.txt", intern=FALSE)
    fixed.par <- GenerateSomaticGrowthParameters(results[i,"vb.Linf.factor"],  results[i,"vb.k.factor"], results[i,"rec.age"])
i <- 1
    fixed.par <- GenerateSomaticGrowthParameters(results[i,"vb.Linf.factor"],  results[i,"vb.k.factor"], results[i,"rec.age"])
source("UsefulFunctions.R")
    fixed.par <- GenerateSomaticGrowthParameters(results[i,"vb.Linf.factor"],  results[i,"vb.k.factor"], results[i,"rec.age"])
    write.inputfile(fixed.par)
    fit <- system("DelayDifference_Option3 Data/SimData4.txt FixedWeeklyParameters.txt", intern=FALSE)
source("TestSensitivity.R")
source("TestSensitivity.R")
source("TestSensitivity.R")
source("TestSensitivity.R")
source("TestSensitivity.R")
results[,"ExitStatus"] <- 0
head(results)
source("TestSensitivity.R")
results
# An object holding the results
results <- expand.grid( vb.Linf.factor = seq(0.9,1.1,0.1), vb.k.factor = seq(0.9,1.1,0.1), rec.age = seq(20,24))
results[,"ExitStatus"] <- NA
head(results)
read.table(file = "Results/FitOutcome.txt", skip = 3, nrow =1, sep = ":")$V2
system("cat Results/FitOutcome.txt")
source("TestSensitivity.R")
results
with(subset(results, rec.age ==23), contour(   vb.Linf.factor, vb.k.factor, logL))
?contour
with(subset(results, rec.age ==23), tapply(logL, list(vb.Linf.factor, vb.k.factor, logL))
Error in contour.default(vb.Linf.factor, vb.k.factor, logL) : 
with(subset(results, rec.age ==23), tapply(logL, list(vb.Linf.factor, vb.k.factor, logL), I))
with(subset(results, rec.age ==23), tapply(logL, list(vb.Linf.factor, vb.k.factor), I))
a.df <- with(subset(results, rec.age ==23), tapply(logL, list(vb.Linf.factor, vb.k.factor), I))
contour(seq(0.9,1.1,0.1), seq(0.9,1.1,0.1), a.df)
a.df <- with(subset(results, rec.age ==22), tapply(logL, list(vb.Linf.factor, vb.k.factor), I))
contour(seq(0.9,1.1,0.1), seq(0.9,1.1,0.1), a.df)
a.df
with(results, which(logL == min(logL)))
with(results, which(logL == min(logL)))res
results
with(results, min(logL)
)
with(results, min(logL, na.rm = T))
with(results, which(logL == min(logL, na.rm = T)))
results[9,]
?contour
source("TestSensitivity.R")
source("TestSensitivity.R")
a.df
contour(v.Linf, v.k, a.df)
a.df
source("TestSensitivity.R")
with(results, which(logL == min(logL, na.rm = T)))
a.df <- with(subset(results, rec.age ==22), tapply(logL, list(vb.Linf.factor, vb.k.factor), I))
contour(v.Linf, v.k, a.df)
a.df
?contour
with(results, which(logL == min(logL, na.rm = T)))
a.df <- with(subset(results, rec.age ==22), tapply(logL, list(vb.Linf.factor, vb.k.factor), I))
contour(v.Linf, v.k, a.df)
contour(v.Linf, v.k, a.df - min(a.df, na.rm=TRUE))
?contour
contour(v.Linf, v.k, a.df - min(a.df, na.rm=TRUE), levels = c(0, 1e-2, 1e-1, 1, 10, 100))
contour(v.Linf, v.k, a.df - min(a.df, na.rm=TRUE), levels = c(0, 1e-3, 1e-2, 1e-1, 1, 10, 100))
with(results, which(logL == min(logL, na.rm = T)))
results[782,]
with(results, which(logL == min(logL, na.rm = T)))
with(subset(results, rec.age ==22), which(logL == min(logL, na.rm = T)))
results[154,]
with(subset(results, rec.age ==22), cbind(vb.Linf.factor[154], vb.k.factor[154], rec.age[154]))
a.df
min(a.df, na.rm=T)
a.df - min(a.df, na.rm=T)
contour(v.Linf, v.k, a.df - min(a.df, na.rm=TRUE), levels = c(0, 1e-3, 1e-2, 1e-1, 1, 10, 100))
contour(v.Linf, v.k, a.df - min(a.df, na.rm=TRUE), levels = 10^seq(-5,0))
source("TestSensitivity.R")
a.df
source("TestSensitivity.R")
a.df
a.df - min(a.df)
source("TestSensitivity.R")
a.df - min(a.df, na.rm = T)
a.df
source("TestSensitivity.R")
print(a.df - min(a.df, na.rm = T))
source("TestSensitivity.R")
par(mfrow=c(1,1))
contour(v.Linf, v.k, a.df - min(a.df, na.rm=TRUE), levels = 10^seq(-5,0))
print(a.df - min(a.df, na.rm = T))
source("TestSensitivity.R")
contour(v.Linf, v.k, a.df - min(a.df, na.rm=TRUE), levels = 10^seq(-8,0))
source("TestSensitivity.R")
source("TestSensitivity.R")
with(results, which(logL == min(logL, na.rm = T)))
results[50,]
source("TestSensitivity.R")
results[50,]
with(results, which(logL == min(logL, na.rm = T)))
source("TestSensitivity.R")
with(results, which(logL == min(logL, na.rm = T)))
results[110,]
source("TestSensitivity.R"); index <- with(results, which(logL == min(logL, na.rm = T))); results[index,]
source("TestSensitivity.R"); index <- with(results, which(logL == min(logL, na.rm = T))); results[index,]
source("TestSensitivity.R"); index <- with(results, which(logL == min(logL, na.rm = T))); results[index,]
source("TestSensitivity.R"); index <- with(results, which(logL == min(logL, na.rm = T))); results[index,]
source("TestSensitivity.R"); index <- with(results, which(logL == min(logL, na.rm = T))); results[index,]
source("TestSensitivity.R"); index <- with(results, which(logL == min(logL, na.rm = T))); results[index,]
source("TestSensitivity.R"); index <- with(results, which(logL == min(logL, na.rm = T))); results[index,]
head(results)
cor(results[,1:3])
source("TestSensitivity.R"); index <- with(results, which(logL == min(logL, na.rm = T))); results[index,]
source("TestSensitivity.R"); index <- with(results, which(logL == min(logL, na.rm = T))); results[index,]
source("TestSensitivity.R"); index <- with(results, which(logL == min(logL, na.rm = T))); results[index,]
source("TestSensitivity.R"); index <- with(results, which(logL == min(logL, na.rm = T))); results[index,]
